# 漏洞概念

### **漏洞基础概念**

**定义**： 漏洞是计算机系统/软件中**非预期的缺陷**，可能被恶意利用来破坏**机密性（C）、完整性（I）或可用性（A）**（即CIA三要素）。



### **核心特点**

1. **非故意存在**：开发时未考虑到的错误或疏忽 *（例如：忘记检查用户输入长度）*
2. **可被触发**：通过特定输入或操作激活 *（例如：向程序发送超长字符串导致崩溃）*
3. **产生危害**：可能导致数据泄露、系统崩溃或控制权丢失



### **类比理解**

就像一栋房子的：

- **没锁的窗户**（漏洞）
- **小偷**（攻击者）
- **爬窗盗窃**（漏洞利用）



### **最简分类**

| 类型     | 例子                |
| -------- | ------------------- |
| 代码漏洞 | 缓冲区溢出、SQL注入 |
| 配置漏洞 | 默认密码、开放端口  |
| 设计漏洞 | 权限验证逻辑缺失    |

**关键点**：漏洞本身只是潜在风险，是否被利用取决于攻击者的能力和防护措施。



# 漏洞复现

生产环境

测试环境

开发环境

在测试环境中进行漏洞检测





# 端口漏洞



## FTP-21

```zsh
FTP:文件传输协议,使用TCP端口20、21,20用于传输数据,21用于传输控制信息

(1) ftp基础爆破: owasp的Bruter,hydra以及msf中的ftp爆破模块。
(2) ftp匿名访问: 用户名: anonymous 密码: 为空或者任意邮箱
(3) vsftpd后门: vsftpd 2到2.3.4版本存在后门漏洞,通过该漏洞获取root权限。
(4) 嗅探: ftp使用明文传输,使用Cain进行渗透。(但是嗅探需要在局域网并需要欺骗或监听网关)
(5) ftp远程代码溢出。
(6) ftp跳转攻击。
```



## SSH-22

```zsh
SSH: (secure shell)是目前较可靠,专为远程登录会话和其他网络服务提供安全性的协议。

(1) 弱口令,可使用工具hydra, msf中的ssh爆破模块。
(2) SSH后门
(3) openssh 用户枚举 CVE-2018-15473。
```



## Telnet-23

```zsh
Telnet协议是TCP/IP协议族中的一员,是Internet远程登录服务的标准协议和主要方式。

(1) 暴力破解，使用hydra,或者msf中telnet模块对其进行破解。
(2) 在linux系统中一般采用SSH进行远程访问，传输的敏感数据都是经过加密的。而对于windows下的telnet来说是脆弱的，因为默认没有经过任何加密就在网络中进行传输。使用cain等嗅探工具可轻松截获远程登录密码。
```



## SMTP-25/465

```zsh
smtp: 邮件协议, 在linux中默认开启这个服务, 可发送钓鱼邮件

默认端口: 25 (smtp)、465 (smtps)

(1) 爆破: 弱口令, 使用hydra
(2) SMTP 无认证伪造发件人
```



## WWW-80

```zsh
为超文本传输协议(HTTP)开放的端口,主要用于万维网传输信息的协议

(1) 中间件漏洞,如IIS、apache、nginx等
(2) 80端口一般通过web应用程序的常见漏洞进行攻击
```




## NetBIOS SessionService-139/455

```zsh
139用于提供windows文件和打印机共享及UNIX中的Samba服务。
445用于提供windows文件和打印机共享
(1) 对于开放139/445端口,尝试利用MS17010溢出漏洞进行攻击;
(2) 对于只开放445端口,尝试利用MS06040、MS08067溢出漏洞攻击;
(3) 利用IPC$连接进行渗透
```




## Mysql-3306

```zsh
3306是MYSQL数据库默认的监听端口
(1) mysql弱口令破解
(2) 弱口令登录mysql,上传构造的恶意UDF自定义函数代码,通过调用注册的恶意函数执行系统命令
(3) SQL注入获取数据库敏感信息, load_file()函数读取系统文件,导出恶意代码到指定路径
```




## Redis-6379

```zsh
开源的可基于内存的可持久化的日志型数据库。

(1) 爆破弱口令
(2) redis未授权访问结合ssh key提权
(3) 主从复制rce
```



## Weblogic-7001

```zsh
(1) 弱口令、爆破, 弱密码一般为weblogic/Oracle@123 or weblogic
(2) 管理后台部署 war包后门
(3) weblogic SSRF
(4) 反序列化漏洞
```



## Tomcat-8080

```zsh
(1) Tomcat远程代码执行漏洞 (CVE-2019-0232)
(2) Tomcat任意文件上传 (CVE-2017-12615)
(3) tomcat管理页面弱口令getshell
```



# Fastjson



Fastjson是阿里巴巴公司开源的一款json解析器,其性能优越,被广泛应用于各大厂商的Java项目中。

### 识别

fastjson的作用是用于对JSON格式的数据进行解析和打包,所以出现json格式的地方就有可能使用了fastjson



# Jboss

### 简介

一个基于J2EE的开放源代码的应用服务器。JBoss是一个管理EJB的容器和服务器，
但JBoss核心服务不包括支持servlet/JSP的WEB容器，一般与Tomcat或Jetty绑定使
用。Jboss是Java EE应用服务器（就像Apache是web服务器一样），专门用来运行
Java EE程序的。

### 批量漏洞扫描

https://github.com/GGyao/jbossScan

### CVE-2017-12149漏洞利用(反弹shell)

https://github.com/joaomatosf/jexboss



# Redis

### 简介

Redis 是完全开源的,遵守 BSD 协议,是一个高性能的 key-value 数据库。

**应用场景**

- 存储 缓存用的数据
- 需要高速读/写的场合使用它快速读/写;

### 识别

默认端口:6379

**nmap**

```bash
nmap -v -Pn -p 6379 -sV --script="redis-info"

-v:显示过程
-Pn: no ping
-sV:版本探测
```

### 批量漏洞扫描


### 历史漏洞



# Shiro

### 简介

Apache Shiro是一个强大易用的Java安全框架,提供了认证、授权、加密和会话管理等功能。Shiro框架直观、易用,同时也能提供健壮的安全性。

### 识别

抓包:显示rememberMe=deleteMe

### 批量漏洞扫描

https://github.com/fupinglee/ShiroScan

http://www.dnslog.cn/

### 历史漏洞



# Struts2

### 简介

Apache Struts是美国阿帕奇(Apache)软件基金会负责维护的一个开源项目,是
一套用于创建企业级Java Web 应用的开源MVC框架,主要提供两个版本框架产品:
Struts 1和Struts 2truts2是一个基于MVC设计模式的Web应用框架,它本质上相当
于一个servlet,在MVC设计模式中,Struts2作为控制器(Controller)来建立模型与
视图的数据交互。Struts 2是Struts的下一代产品,是在 struts 1和WebWork的技
术基础上进行了合并的全新的Struts 2框架。

### 框架识别

1. 通过网址后缀:.do,.action
2. 判断/struts/webconsole.html是否参在来判断,需要devMode为true

### 批量漏洞扫描

https://github.com/abc123info/Struts2VulsScanTools



# ThinkPHP

### 简介

ThinkPHP是一个快速、兼容而且简单的轻量级国产PHP开发框架,诞生于2006年初,
原名FCS,2007年元旦正式更名为ThinkPHP,遵循Apache2开源协议发布,从
Struts结构移植过来并做了改进和完善,同时也借鉴了国外很多优秀的框架和模式,
使用面向对象的开发结构和MVC模式,融合了Struts的思想和TagLib(标签库)、
RoR的ORM映射和ActiveRecord模式。

ThinkPHP可以支持windows/Unix/Linux等服务器环境,正式版需要PHP5.0以上
版本支持,支持MySql、PgSQL、Sqlite多种数据库以及PDO扩展,ThinkPHP框架
本身没有什么特别模块要求,具体的应用系统运行环境要求视开发所涉及的模块。

### 漏洞

许多cms是基于thinkphp5开发的,所以如果thinkphp5有漏洞的话,会影响许多thinkphp开发的网站

### 批量检测漏洞

https://github.com/admintony/thinkPHPBatchPoc



# Weblogic

### 简介

WebLogic是美国Oracle公司出品的一个application server,确切的说是一个基于
JAVAEE架构的中间件,WebLogic是用于开发、集成、部署和管理大型分布式Web
应用、网络应用和数据库应用的Java应用服务器。将Java的动态功能和Java
Enterprise标准的安全性引入大型网络应用的开发、集成、部署和管理之中



### 特征

端口:7001
web界面:Error 404-Not Found



### 批量检测漏洞

https://github.com/rabbitmask/WeblogicScan
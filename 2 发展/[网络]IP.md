## IP地址基础概念

IP地址(Internet Protocol Address)是分配给网络设备的数字标签，用于在网络中唯一标识设备并实现通信。

### IP地址的组成

一个IPv4地址由32位二进制数组成，通常表示为4个十进制数（每个0-255），用点分隔：
```
192.168.1.1
```

## IP地址分类

### 1. IPv4地址

IPv4使用32位地址，约43亿个地址，目前已接近耗尽。

**IPv4地址结构**：
- 网络部分：标识网络
- 主机部分：标识网络中的设备

**IPv4地址类别**：

| 类别 | 范围                | 用途                     |
|------|---------------------|--------------------------|
| A    | 1.0.0.0 - 126.255.255.255 | 大型网络(政府/大企业) |
| B    | 128.0.0.0 - 191.255.255.255 | 中型网络(大学/中型企业) |
| C    | 192.0.0.0 - 223.255.255.255 | 小型网络(SOHO/家庭) |
| D    | 224.0.0.0 - 239.255.255.255 | 组播地址 |
| E    | 240.0.0.0 - 255.255.255.255 | 保留地址 |

### 2. IPv6地址

IPv6使用128位地址，解决了IPv4地址耗尽问题。

**IPv6地址表示**：
- 8组4位十六进制数，用冒号分隔
- 示例：`2001:0db8:85a3:0000:0000:8a2e:0370:7334`
- 可以简写：`2001:db8:85a3::8a2e:370:7334`

## 特殊IP地址

### 私有IP地址范围

这些地址在互联网上不可路由，用于内部网络：

- `10.0.0.0/8` (10.0.0.0 - 10.255.255.255)
- `172.16.0.0/12` (172.16.0.0 - 172.31.255.255)
- `192.168.0.0/16` (192.168.0.0 - 192.168.255.255)

### 其他特殊地址

- `127.0.0.1`：本地回环地址(本机)
- `0.0.0.0`：所有可用网络接口
- `255.255.255.255`：有限广播地址
- `169.254.0.0/16`：链路本地地址(当DHCP失败时自动分配)

## 子网划分与CIDR

### 子网掩码

用于区分IP地址中的网络部分和主机部分：
- `255.255.255.0` = `/24`
- `255.255.0.0` = `/16`
- `255.0.0.0` = `/8`

### CIDR表示法

无类别域间路由(CIDR)表示法：
- `192.168.1.0/24`：表示前24位是网络地址
- `10.0.0.0/8`：表示前8位是网络地址

## IP地址分配方式

1. **静态IP**：手动配置，固定不变
2. **动态IP**：通过DHCP自动分配
3. **APIPA**：当DHCP失败时自动分配(169.254.x.x)

## Arch Linux中的IP管理

### 查看IP信息

```bash
ip addr show  # 显示所有网络接口信息
ip -4 addr   # 仅显示IPv4地址
ip -6 addr   # 仅显示IPv6地址
```

### 配置临时IP地址

```bash
sudo ip addr add 192.168.1.100/24 dev eth0
```

### 永久配置IP地址

编辑网络配置文件：
```bash
sudo vim /etc/netctl/your-profile
```

或使用NetworkManager：
```bash
nmcli connection modify "Your Connection" ipv4.addresses "192.168.1.100/24"
nmcli connection up "Your Connection"
```

## IP路由

### 查看路由表

```bash
ip route show
# 或
route -n
```

### 添加路由

```bash
sudo ip route add 10.0.0.0/8 via 192.168.1.1 dev eth0
```

## 网络诊断工具

1. 测试连通性：
```bash
ping -c 4 google.com
```

2. 追踪路由：
```bash
traceroute google.com
# 或
mtr google.com
```

3. 检查DNS解析：
```bash
dig +short google.com
# 或
host google.com
```

4. 扫描网络：
```bash
nmap -sn 192.168.1.0/24  # 发现活动主机
nmap -sV 192.168.1.1    # 扫描服务版本
```
